[
  {
    "type": "function",
    "function": {
      "name": "qualify_lead",
      "description": "Evaluate prospect using BANT (Budget, Authority, Need, Timeline). Call after collecting qualification info.",
      "parameters": {
        "type": "object",
        "properties": {
          "need": { "type": "string", "enum": ["high", "medium", "low", "unknown"] },
          "timeline": { "type": "string", "enum": ["immediate", "this_quarter", "this_year", "exploring"] },
          "budget": { "type": "string", "enum": ["defined", "flexible", "limited", "unknown"] },
          "authority": { "type": "string", "enum": ["decision_maker", "influencer", "user", "unknown"] },
          "industry": { "type": "string" },
          "company_size": { "type": "string", "enum": ["solo", "small", "medium", "large"] }
        },
        "required": ["need", "timeline"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "handle_objection",
      "description": "Log a prospect objection for analytics and adapt response.",
      "parameters": {
        "type": "object",
        "properties": {
          "objection_type": { "type": "string", "enum": ["price", "timing", "competitor", "authority", "need", "trust", "other"] },
          "objection_text": { "type": "string" }
        },
        "required": ["objection_type", "objection_text"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "check_order_status",
      "description": "Check order status via customer email.",
      "parameters": {
        "type": "object",
        "properties": {
          "email": { "type": "string", "description": "Customer email associated with the order" }
        },
        "required": ["email"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "check_product_stock",
      "description": "Check product stock availability.",
      "parameters": {
        "type": "object",
        "properties": {
          "query": { "type": "string", "description": "Product name or description to search" }
        },
        "required": ["query"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_customer_tags",
      "description": "Retrieve customer tags and segments.",
      "parameters": {
        "type": "object",
        "properties": {
          "email": { "type": "string" }
        },
        "required": ["email"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "schedule_callback",
      "description": "Schedule a callback or follow-up action.",
      "parameters": {
        "type": "object",
        "properties": {
          "callback_time": { "type": "string" },
          "next_action": { "type": "string", "enum": ["call_back", "send_email", "send_sms_booking_link", "send_info_pack"] },
          "notes": { "type": "string" }
        },
        "required": ["next_action"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "create_booking",
      "description": "Create a discovery appointment booking when prospect is qualified.",
      "parameters": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "email": { "type": "string" },
          "phone": { "type": "string" },
          "slot": { "type": "string" },
          "meeting_type": { "type": "string", "enum": ["discovery_call", "demo", "audit", "consultation"] },
          "qualification_score": { "type": "string", "enum": ["hot", "warm", "cold"] },
          "notes": { "type": "string" }
        },
        "required": ["name", "email", "slot"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "track_conversion_event",
      "description": "Track funnel conversion steps for analytics.",
      "parameters": {
        "type": "object",
        "properties": {
          "event": { "type": "string", "enum": ["call_started", "permission_granted", "qualification_complete", "objection_raised", "objection_resolved", "closing_attempted", "booking_created", "callback_scheduled", "call_abandoned", "call_completed"] },
          "stage": { "type": "string", "enum": ["opening", "qualification", "value_prop", "objection_handling", "closing", "follow_up"] },
          "outcome": { "type": "string", "enum": ["success", "partial", "failed", "pending"] }
        },
        "required": ["event", "stage"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "search_knowledge_base",
      "description": "Search for specific information (hours, policies, services) in the client knowledge base.",
      "parameters": {
        "type": "object",
        "properties": {
          "query": { "type": "string" },
          "category": { "type": "string" }
        },
        "required": ["query"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "send_payment_details",
      "description": "Send bank details (RIB/IBAN/Wise) or a payment link.",
      "parameters": {
        "type": "object",
        "properties": {
          "amount": { "type": "number" },
          "description": { "type": "string" },
          "method_override": { "type": "string", "enum": ["BANK_TRANSFER", "LINK", "CASH"] }
        },
        "required": ["amount", "description"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "transfer_call",
      "description": "Transfer the call to a human agent (emergency, complex request, handoff).",
      "parameters": {
        "type": "object",
        "properties": {
          "reason": { "type": "string" },
          "phone_number": { "type": "string" }
        },
        "required": ["reason"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "handle_complaint",
      "description": "Handle a customer complaint. REQUIRED before any financial promise (refund, compensation, free offer).",
      "parameters": {
        "type": "object",
        "properties": {
          "complaint_type": { "type": "string", "enum": ["defective_product", "late_delivery", "wrong_item", "poor_service", "billing_error", "damaged_goods", "missing_parts", "warranty_claim", "refund_request", "other"] },
          "proposed_resolution": { "type": "string" },
          "financial_commitment": { "type": "boolean" },
          "estimated_value": { "type": "number" },
          "customer_email": { "type": "string" },
          "severity": { "type": "string", "enum": ["low", "medium", "high", "critical"] }
        },
        "required": ["complaint_type", "proposed_resolution", "financial_commitment"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "browse_catalog",
      "description": "Browse product/service catalog by category.",
      "parameters": {
        "type": "object",
        "properties": {
          "category": { "type": "string" },
          "limit": { "type": "number" },
          "in_stock_only": { "type": "boolean" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_item_details",
      "description": "Get full details for a specific item (product, dish, service, vehicle).",
      "parameters": {
        "type": "object",
        "properties": {
          "item_id": { "type": "string" },
          "item_name": { "type": "string" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_menu",
      "description": "Get full restaurant/bakery menu with categories, prices and allergens.",
      "parameters": {
        "type": "object",
        "properties": {
          "category": { "type": "string" },
          "dietary": { "type": "string", "enum": ["vegan", "vegetarian", "gluten-free", "halal"] }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "check_item_availability",
      "description": "Check item availability (product stock, dish availability, service slot, vehicle dates).",
      "parameters": {
        "type": "object",
        "properties": {
          "item_id": { "type": "string" },
          "item_name": { "type": "string" },
          "date": { "type": "string" },
          "quantity": { "type": "number" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "search_catalog",
      "description": "Search catalog items by keyword.",
      "parameters": {
        "type": "object",
        "properties": {
          "query": { "type": "string" },
          "category": { "type": "string" },
          "max_price": { "type": "number" }
        },
        "required": ["query"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_services",
      "description": "Get available services list (garage, salon, spa, doctor, etc.).",
      "parameters": {
        "type": "object",
        "properties": {
          "category": { "type": "string" },
          "date": { "type": "string" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_available_slots",
      "description": "Get available time slots for a service.",
      "parameters": {
        "type": "object",
        "properties": {
          "service_id": { "type": "string" },
          "service_name": { "type": "string" },
          "date": { "type": "string" },
          "provider_id": { "type": "string" }
        },
        "required": ["date"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_packages",
      "description": "Get available packages and bundles (hotel, events, spa).",
      "parameters": {
        "type": "object",
        "properties": {
          "category": { "type": "string" },
          "max_price": { "type": "number" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_vehicles",
      "description": "Get available rental vehicles.",
      "parameters": {
        "type": "object",
        "properties": {
          "vehicle_type": { "type": "string", "enum": ["citadine", "berline", "suv", "utilitaire", "luxe"] },
          "start_date": { "type": "string" },
          "end_date": { "type": "string" },
          "transmission": { "type": "string", "enum": ["manuelle", "automatique"] }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_trips",
      "description": "Get available trips and tours.",
      "parameters": {
        "type": "object",
        "properties": {
          "destination": { "type": "string" },
          "trip_type": { "type": "string", "enum": ["circuit", "sejour", "weekend", "croisiere"] },
          "max_budget": { "type": "number" },
          "departure_month": { "type": "string" }
        },
        "required": []
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_recommendations",
      "description": "Get personalized recommendations (products, services, content) based on context.",
      "parameters": {
        "type": "object",
        "properties": {
          "product_id": { "type": "string" },
          "product_ids": { "type": "array", "items": { "type": "string" } },
          "recommendation_type": { "type": "string", "enum": ["similar", "bought_together", "personalized"] },
          "limit": { "type": "number" }
        },
        "required": ["recommendation_type"]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "start_product_quiz",
      "description": "Start a voice quiz to help the customer find the ideal product.",
      "parameters": {
        "type": "object",
        "properties": {
          "quiz_type": { "type": "string", "enum": ["skincare", "electronics", "generic"] },
          "first_question": { "type": "string" }
        },
        "required": []
      }
    }
  }
]
